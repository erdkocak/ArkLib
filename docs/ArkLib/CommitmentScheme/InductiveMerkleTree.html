<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../.././style.css"></link><link rel="icon" href="../.././favicon.svg"></link><link rel="mask-icon" href="../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../.././/declarations/declaration-data.bmp" as="image"></link><title>ArkLib.CommitmentScheme.InductiveMerkleTree</title><script defer="true" src="../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../.././";</script><script>const MODULE_NAME="ArkLib.CommitmentScheme.InductiveMerkleTree";</script><script type="module" src="../.././jump-src.js"></script><script type="module" src="../.././search.js"></script><script type="module" src="../.././expand-nav.js"></script><script type="module" src="../.././how-about.js"></script><script type="module" src="../.././instances.js"></script><script type="module" src="../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">ArkLib</span>.<span class="name">CommitmentScheme</span>.<span class="name">InductiveMerkleTree</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/InductiveMerkleTree.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../.././Init.html">Init</a></li><li><a href="../.././VCVio.html">VCVio</a></li><li><a href="../.././ArkLib/CommitmentScheme/Basic.html">ArkLib.CommitmentScheme.Basic</a></li><li><a href="../.././ArkLib/ToVCVio/Oracle.html">ArkLib.ToVCVio.Oracle</a></li><li><a href="../.././Mathlib/Data/Vector/Snoc.html">Mathlib.Data.Vector.Snoc</a></li><li><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html">ArkLib.ToMathlib.Data.IndexedBinaryTree.Basic</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-ArkLib.CommitmentScheme.InductiveMerkleTree" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#InductiveMerkleTree.spec"><span class="name">InductiveMerkleTree</span>.<span class="name">spec</span></a></div><div class="nav_link"><a class="break_within" href="#InductiveMerkleTree.domain_def"><span class="name">InductiveMerkleTree</span>.<span class="name">domain_def</span></a></div><div class="nav_link"><a class="break_within" href="#InductiveMerkleTree.range_def"><span class="name">InductiveMerkleTree</span>.<span class="name">range_def</span></a></div><div class="nav_link"><a class="break_within" href="#InductiveMerkleTree.singleHash"><span class="name">InductiveMerkleTree</span>.<span class="name">singleHash</span></a></div><div class="nav_link"><a class="break_within" href="#InductiveMerkleTree.buildMerkleTree"><span class="name">InductiveMerkleTree</span>.<span class="name">buildMerkleTree</span></a></div><div class="nav_link"><a class="break_within" href="#InductiveMerkleTree.buildMerkleTree_with_hash"><span class="name">InductiveMerkleTree</span>.<span class="name">buildMerkleTree_with_hash</span></a></div><div class="nav_link"><a class="break_within" href="#InductiveMerkleTree.runWithOracle_buildMerkleTree"><span class="name">InductiveMerkleTree</span>.<span class="name">runWithOracle_buildMerkleTree</span></a></div><div class="nav_link"><a class="break_within" href="#InductiveMerkleTree.generateProof"><span class="name">InductiveMerkleTree</span>.<span class="name">generateProof</span></a></div><div class="nav_link"><a class="break_within" href="#InductiveMerkleTree.generateProof_leaf"><span class="name">InductiveMerkleTree</span>.<span class="name">generateProof_leaf</span></a></div><div class="nav_link"><a class="break_within" href="#InductiveMerkleTree.generateProof_ofLeft"><span class="name">InductiveMerkleTree</span>.<span class="name">generateProof_ofLeft</span></a></div><div class="nav_link"><a class="break_within" href="#InductiveMerkleTree.generateProof_ofRight"><span class="name">InductiveMerkleTree</span>.<span class="name">generateProof_ofRight</span></a></div><div class="nav_link"><a class="break_within" href="#InductiveMerkleTree.getPutativeRoot"><span class="name">InductiveMerkleTree</span>.<span class="name">getPutativeRoot</span></a></div><div class="nav_link"><a class="break_within" href="#InductiveMerkleTree.getPutativeRoot_with_hash"><span class="name">InductiveMerkleTree</span>.<span class="name">getPutativeRoot_with_hash</span></a></div><div class="nav_link"><a class="break_within" href="#InductiveMerkleTree.runWithOracle_getPutativeRoot"><span class="name">InductiveMerkleTree</span>.<span class="name">runWithOracle_getPutativeRoot</span></a></div><div class="nav_link"><a class="break_within" href="#InductiveMerkleTree.verifyProof"><span class="name">InductiveMerkleTree</span>.<span class="name">verifyProof</span></a></div><div class="nav_link"><a class="break_within" href="#InductiveMerkleTree.functional_completeness"><span class="name">InductiveMerkleTree</span>.<span class="name">functional_completeness</span></a></div><div class="nav_link"><a class="break_within" href="#InductiveMerkleTree.completeness"><span class="name">InductiveMerkleTree</span>.<span class="name">completeness</span></a></div></nav><main>
<div class="mod_doc"><h1 class="markdown-heading" id="Inductive-Merkle-Trees">Inductive Merkle Trees <a class="hover-link" href="#Inductive-Merkle-Trees">#</a></h1><p>This file implements Merkle Trees. In contrast to the other Merkle tree implementation in
<code>ArkLib.CommitmentScheme.MerkleTree</code>, this one is defined inductively.</p><h2 class="markdown-heading" id="Implementation-Notes">Implementation Notes <a class="hover-link" href="#Implementation-Notes">#</a></h2><p>This works with trees that are indexed inductive binary trees,
(i.e. indexed in that their definitions and methods carry parameters regarding their structure)
as defined in <code>ArkLib.Data.IndexedBinaryTree</code>.</p><ul>
<li>We found that the inductive definition seems likely to be convenient for a few reasons:<ul>
<li>It allows us to handle non-perfect trees.</li>
<li>It can allow us to use trees of arbitrary structure in the extractor.</li>
</ul>
</li>
<li>I considered the indexed type useful because the completeness theorem and extractibility theorems
take indices or sets of indices as parameters,
and because we are working with trees of arbitrary structure,
this lets us avoid having to check that these indices are valid.</li>
</ul><h2 class="markdown-heading" id="Plan-TODOs">Plan/TODOs <a class="hover-link" href="#Plan-TODOs">#</a></h2><ul>
<li class="task-list-item"><input checked="true" class="task-list-item-checkbox" disabled="true" type="checkbox"></input>Basic Merkle tree API<ul>
<li class="task-list-item"><input checked="true" class="task-list-item-checkbox" disabled="true" type="checkbox"></input><code><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.buildMerkleTree">buildMerkleTree</a></code></li>
<li class="task-list-item"><input checked="true" class="task-list-item-checkbox" disabled="true" type="checkbox"></input><code><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.generateProof">generateProof</a></code></li>
<li class="task-list-item"><input checked="true" class="task-list-item-checkbox" disabled="true" type="checkbox"></input><code><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.getPutativeRoot">getPutativeRoot</a></code></li>
<li class="task-list-item"><input checked="true" class="task-list-item-checkbox" disabled="true" type="checkbox"></input><code><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.verifyProof">verifyProof</a></code></li>
</ul>
</li>
<li class="task-list-item"><input checked="true" class="task-list-item-checkbox" disabled="true" type="checkbox"></input>Completeness theorem</li>
<li class="task-list-item"><input class="task-list-item-checkbox" disabled="true" type="checkbox"></input>Collision Lemma (See SNARGs book 18.3)<ul>
<li>(this is really not a lemma about oracles, so it could go with the binary tree API)</li>
</ul>
</li>
<li class="task-list-item"><input class="task-list-item-checkbox" disabled="true" type="checkbox"></input>Extractibility (See SNARGs book 18.5)</li>
<li class="task-list-item"><input class="task-list-item-checkbox" disabled="true" type="checkbox"></input>Multi-leaf proofs</li>
<li class="task-list-item"><input class="task-list-item-checkbox" disabled="true" type="checkbox"></input>Arbirary arity trees</li>
<li class="task-list-item"><input class="task-list-item-checkbox" disabled="true" type="checkbox"></input>Multi-instance</li>
</ul></div><div class="decl" id="InductiveMerkleTree.spec"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/InductiveMerkleTree.lean#L59-L65">source</a></div><div class="attributes">@[reducible]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.spec"><span class="name">InductiveMerkleTree</span>.<span class="name">spec</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././VCVio/OracleComp/OracleSpec.html#OracleSpec">OracleSpec</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Define the domain &amp; range of the (single) oracle needed for constructing a Merkle tree with
elements from some type <code>α</code>.</p><p>We may instantiate <code>α</code> with <code><a href="../.././Init/Prelude.html#BitVec">BitVec</a> n</code> or <code><a href="../.././Init/Prelude.html#Fin">Fin</a> (2 ^ n)</code> to construct a Merkle tree for boolean
vectors of length <code>n</code>.</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-InductiveMerkleTree.spec" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="InductiveMerkleTree.domain_def"><div class="theorem"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/InductiveMerkleTree.lean#L67-L68">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.domain_def"><span class="name">InductiveMerkleTree</span>.<span class="name">domain_def</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn"><span class="fn">(<a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.spec">spec</a> <span class="fn">α</span>)</span>.<a href="../.././VCVio/OracleComp/OracleSpec.html#OracleSpec.domain">domain</a></span> <a href="../.././Init/Prelude.html#Unit.unit">(</a><a href="../.././Init/Prelude.html#Unit.unit">)</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> (<span class="fn">α</span> <a href="../.././Init/Prelude.html#Prod">×</a> <span class="fn">α</span>)</div></div></div></div><div class="decl" id="InductiveMerkleTree.range_def"><div class="theorem"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/InductiveMerkleTree.lean#L70-L71">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.range_def"><span class="name">InductiveMerkleTree</span>.<span class="name">range_def</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn"><span class="fn">(<a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.spec">spec</a> <span class="fn">α</span>)</span>.<a href="../.././VCVio/OracleComp/OracleSpec.html#OracleSpec.range">range</a></span> <a href="../.././Init/Prelude.html#Unit.unit">(</a><a href="../.././Init/Prelude.html#Unit.unit">)</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">α</span></div></div></div></div><div class="decl" id="InductiveMerkleTree.singleHash"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/InductiveMerkleTree.lean#L78-L81">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.singleHash"><span class="name">InductiveMerkleTree</span>.<span class="name">singleHash</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">left </span><span class="fn">right</span> : <span class="fn">α</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././VCVio/OracleComp/OracleComp.html#OracleComp">OracleComp</a> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.spec">spec</a> <span class="fn">α</span>)</span> <span class="fn">α</span></span></div></div><p>Example: a single hash computation</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-InductiveMerkleTree.singleHash" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="InductiveMerkleTree.buildMerkleTree"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/InductiveMerkleTree.lean#L83-L91">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.buildMerkleTree"><span class="name">InductiveMerkleTree</span>.<span class="name">buildMerkleTree</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">s</span> : <a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.Skeleton">BinaryTree.Skeleton</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">leaf_tree</span> : <span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.LeafData">BinaryTree.LeafData</a> <span class="fn">α</span> <span class="fn">s</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././VCVio/OracleComp/OracleComp.html#OracleComp">OracleComp</a> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.spec">spec</a> <span class="fn">α</span>)</span> <span class="fn">(<a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.FullData">BinaryTree.FullData</a> <span class="fn">α</span> <span class="fn">s</span>)</span></span></div></div><p>Build the full Merkle tree, returning the tree populated with data on all its nodes</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-InductiveMerkleTree.buildMerkleTree" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="InductiveMerkleTree.buildMerkleTree_with_hash"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/InductiveMerkleTree.lean#L93-L105">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.buildMerkleTree_with_hash"><span class="name">InductiveMerkleTree</span>.<span class="name">buildMerkleTree_with_hash</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">s</span> : <a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.Skeleton">BinaryTree.Skeleton</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">leaf_tree</span> : <span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.LeafData">BinaryTree.LeafData</a> <span class="fn">α</span> <span class="fn">s</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hashFn</span> : <span class="fn"><span class="fn">α</span> → <span class="fn">α</span> → <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.FullData">BinaryTree.FullData</a> <span class="fn">α</span> <span class="fn">s</span></span></div></div><p>A functional form of merkle tree construction, that doesn't depend on the monad.
This receives an explicit hash function</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-InductiveMerkleTree.buildMerkleTree_with_hash" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="InductiveMerkleTree.runWithOracle_buildMerkleTree"><div class="theorem"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/InductiveMerkleTree.lean#L107-L127">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.runWithOracle_buildMerkleTree"><span class="name">InductiveMerkleTree</span>.<span class="name">runWithOracle_buildMerkleTree</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">s</span> : <a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.Skeleton">BinaryTree.Skeleton</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">leaf_data_tree</span> : <span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.LeafData">BinaryTree.LeafData</a> <span class="fn">α</span> <span class="fn">s</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">f</span> : <span class="fn"><span class="fn">(<a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.spec">spec</a> <span class="fn">α</span>)</span>.<a href="../.././ArkLib/ToVCVio/Oracle.html#OracleSpec.FunctionType">FunctionType</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././ArkLib/ToVCVio/Oracle.html#OracleComp.runWithOracle">OracleComp.runWithOracle</a> <span class="fn">f</span> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.buildMerkleTree">buildMerkleTree</a> <span class="fn">leaf_data_tree</span>)</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Init/Prelude.html#Option.some">some</a> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.buildMerkleTree_with_hash">buildMerkleTree_with_hash</a> <span class="fn">leaf_data_tree</span> <span class="fn">fun (<span class="fn">left</span> <span class="fn">right</span> : <span class="fn">α</span>) =&gt; <span class="fn"><span class="fn">f</span> <a href="../.././Init/Prelude.html#Unit.unit">(</a><a href="../.././Init/Prelude.html#Unit.unit">)</a> <a href="../.././Init/Prelude.html#Prod.mk">(</a><span class="fn">left</span><a href="../.././Init/Prelude.html#Prod.mk">,</a> <span class="fn">right</span><a href="../.././Init/Prelude.html#Prod.mk">)</a></span></span>)</span></span></div></div><p>Running the monadic version of <code><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.buildMerkleTree">buildMerkleTree</a></code> with an oracle function <code>f</code>
is equivalent to running the functional version of <code><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.buildMerkleTree_with_hash">buildMerkleTree_with_hash</a></code>
with the same oracle function.</p></div></div><div class="decl" id="InductiveMerkleTree.generateProof"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/InductiveMerkleTree.lean#L129-L143">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.generateProof"><span class="name">InductiveMerkleTree</span>.<span class="name">generateProof</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">s</span> : <a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.Skeleton">BinaryTree.Skeleton</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">cache_tree</span> : <span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.FullData">BinaryTree.FullData</a> <span class="fn">α</span> <span class="fn">s</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.SkeletonLeafIndex">BinaryTree.SkeletonLeafIndex</a> <span class="fn">s</span></span> → <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <span class="fn">α</span></span></span></div></div><p>Generate a Merkle proof for a leaf at a given idx
The proof consists of the sibling hashes needed to recompute the root.</p><p>TODO rename this to copath and move to BinaryTree?</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-InductiveMerkleTree.generateProof" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="InductiveMerkleTree.generateProof_leaf"><div class="theorem"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/InductiveMerkleTree.lean#L145-L149">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.generateProof_leaf"><span class="name">InductiveMerkleTree</span>.<span class="name">generateProof_leaf</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">a</span> : <span class="fn">α</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">idx</span> : <span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.SkeletonLeafIndex">BinaryTree.SkeletonLeafIndex</a> <a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.Skeleton.leaf">BinaryTree.Skeleton.leaf</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.generateProof">generateProof</a> <span class="fn">(<a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.FullData.leaf">BinaryTree.FullData.leaf</a> <span class="fn">a</span>)</span> <span class="fn">idx</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#List.nil">[</a><a href="../.././Init/Prelude.html#List.nil">]</a></div></div></div></div><div class="decl" id="InductiveMerkleTree.generateProof_ofLeft"><div class="theorem"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/InductiveMerkleTree.lean#L151-L158">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.generateProof_ofLeft"><span class="name">InductiveMerkleTree</span>.<span class="name">generateProof_ofLeft</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">sleft </span><span class="fn">sright</span> : <a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.Skeleton">BinaryTree.Skeleton</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">cache_tree</span> : <span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.FullData">BinaryTree.FullData</a> <span class="fn">α</span> <span class="fn">(<span class="fn"><span class="fn">sleft</span>.<a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.Skeleton.internal">internal</a></span> <span class="fn">sright</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">idxLeft</span> : <span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.SkeletonLeafIndex">BinaryTree.SkeletonLeafIndex</a> <span class="fn">sleft</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.generateProof">generateProof</a> <span class="fn">cache_tree</span> <span class="fn"><span class="fn">idxLeft</span>.<a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.SkeletonLeafIndex.ofLeft">ofLeft</a></span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><span class="fn"><span class="fn">cache_tree</span>.<a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.FullData.rightSubtree">rightSubtree</a></span>.<a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.FullData.getRootValue">getRootValue</a></span> <a href="../.././Init/Prelude.html#List.cons">::</a> <span class="fn"><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.generateProof">generateProof</a> <span class="fn"><span class="fn">cache_tree</span>.<a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.FullData.leftSubtree">leftSubtree</a></span> <span class="fn">idxLeft</span></span></div></div></div></div><div class="decl" id="InductiveMerkleTree.generateProof_ofRight"><div class="theorem"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/InductiveMerkleTree.lean#L160-L167">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.generateProof_ofRight"><span class="name">InductiveMerkleTree</span>.<span class="name">generateProof_ofRight</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">sleft </span><span class="fn">sright</span> : <a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.Skeleton">BinaryTree.Skeleton</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">cache_tree</span> : <span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.FullData">BinaryTree.FullData</a> <span class="fn">α</span> <span class="fn">(<span class="fn"><span class="fn">sleft</span>.<a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.Skeleton.internal">internal</a></span> <span class="fn">sright</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">idxRight</span> : <span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.SkeletonLeafIndex">BinaryTree.SkeletonLeafIndex</a> <span class="fn">sright</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.generateProof">generateProof</a> <span class="fn">cache_tree</span> <span class="fn"><span class="fn">idxRight</span>.<a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.SkeletonLeafIndex.ofRight">ofRight</a></span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><span class="fn"><span class="fn">cache_tree</span>.<a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.FullData.leftSubtree">leftSubtree</a></span>.<a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.FullData.getRootValue">getRootValue</a></span> <a href="../.././Init/Prelude.html#List.cons">::</a> <span class="fn"><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.generateProof">generateProof</a> <span class="fn"><span class="fn">cache_tree</span>.<a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.FullData.rightSubtree">rightSubtree</a></span> <span class="fn">idxRight</span></span></div></div></div></div><div class="decl" id="InductiveMerkleTree.getPutativeRoot"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/InductiveMerkleTree.lean#L169-L193">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.getPutativeRoot"><span class="name">InductiveMerkleTree</span>.<span class="name">getPutativeRoot</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">s</span> : <a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.Skeleton">BinaryTree.Skeleton</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">idx</span> : <span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.SkeletonLeafIndex">BinaryTree.SkeletonLeafIndex</a> <span class="fn">s</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">leafValue</span> : <span class="fn">α</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">proof</span> : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././VCVio/OracleComp/OracleComp.html#OracleComp">OracleComp</a> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.spec">spec</a> <span class="fn">α</span>)</span> <span class="fn">α</span></span></div></div><p>Given a leaf index, a leaf value at that index, and putative proof,
returns the hash that would be the root of the tree if the proof was valid.
i.e. the hash obtained by combining the leaf in sequence with each member of the proof,
according to its index.</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-InductiveMerkleTree.getPutativeRoot" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="InductiveMerkleTree.getPutativeRoot_with_hash"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/InductiveMerkleTree.lean#L195-L216">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.getPutativeRoot_with_hash"><span class="name">InductiveMerkleTree</span>.<span class="name">getPutativeRoot_with_hash</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">s</span> : <a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.Skeleton">BinaryTree.Skeleton</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">idx</span> : <span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.SkeletonLeafIndex">BinaryTree.SkeletonLeafIndex</a> <span class="fn">s</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">leafValue</span> : <span class="fn">α</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">proof</span> : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hashFn</span> : <span class="fn"><span class="fn">α</span> → <span class="fn">α</span> → <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">α</span></div></div><p>A functional version of <code><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.getPutativeRoot">getPutativeRoot</a></code> that does not depend on the monad.
It receives an explicit hash function <code>hashFn</code> that combines two hashes into one.
And recursively calls itself down the tree.</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-InductiveMerkleTree.getPutativeRoot_with_hash" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="InductiveMerkleTree.runWithOracle_getPutativeRoot"><div class="theorem"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/InductiveMerkleTree.lean#L218-L245">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.runWithOracle_getPutativeRoot"><span class="name">InductiveMerkleTree</span>.<span class="name">runWithOracle_getPutativeRoot</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">s</span> : <a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.Skeleton">BinaryTree.Skeleton</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">idx</span> : <span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.SkeletonLeafIndex">BinaryTree.SkeletonLeafIndex</a> <span class="fn">s</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">leafValue</span> : <span class="fn">α</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">proof</span> : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">f</span> : <span class="fn"><span class="fn">(<a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.spec">spec</a> <span class="fn">α</span>)</span>.<a href="../.././ArkLib/ToVCVio/Oracle.html#OracleSpec.FunctionType">FunctionType</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././ArkLib/ToVCVio/Oracle.html#OracleComp.runWithOracle">OracleComp.runWithOracle</a> <span class="fn">f</span> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.getPutativeRoot">getPutativeRoot</a> <span class="fn">idx</span> <span class="fn">leafValue</span> <span class="fn">proof</span>)</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Init/Prelude.html#Option.some">some</a> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.getPutativeRoot_with_hash">getPutativeRoot_with_hash</a> <span class="fn">idx</span> <span class="fn">leafValue</span> <span class="fn">proof</span> <span class="fn">fun (<span class="fn">left</span> <span class="fn">right</span> : <span class="fn">α</span>) =&gt; <span class="fn"><span class="fn">f</span> <a href="../.././Init/Prelude.html#Unit.unit">(</a><a href="../.././Init/Prelude.html#Unit.unit">)</a> <a href="../.././Init/Prelude.html#Prod.mk">(</a><span class="fn">left</span><a href="../.././Init/Prelude.html#Prod.mk">,</a> <span class="fn">right</span><a href="../.././Init/Prelude.html#Prod.mk">)</a></span></span>)</span></span></div></div><p>Running the monadic version of <code><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.getPutativeRoot">getPutativeRoot</a></code> with an oracle function <code>f</code>,
it is equivalent to running the functional version of <code><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.getPutativeRoot_with_hash">getPutativeRoot_with_hash</a></code></p></div></div><div class="decl" id="InductiveMerkleTree.verifyProof"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/InductiveMerkleTree.lean#L247-L257">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.verifyProof"><span class="name">InductiveMerkleTree</span>.<span class="name">verifyProof</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">α</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">s</span> : <a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.Skeleton">BinaryTree.Skeleton</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">idx</span> : <span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.SkeletonLeafIndex">BinaryTree.SkeletonLeafIndex</a> <span class="fn">s</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">leafValue </span><span class="fn">rootValue</span> : <span class="fn">α</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">proof</span> : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././VCVio/OracleComp/OracleComp.html#OracleComp">OracleComp</a> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.spec">spec</a> <span class="fn">α</span>)</span> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Verify a Merkle proof <code>proof</code> that a given <code>leaf</code> at index <code>i</code> is in the Merkle tree with given
<code>root</code>.
Works by computing the putative root based on the branch, and comparing that to the actual root.
Outputs <code>failure</code> if the proof is invalid.</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-InductiveMerkleTree.verifyProof" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="InductiveMerkleTree.functional_completeness"><div class="theorem"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/InductiveMerkleTree.lean#L259-L292">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.functional_completeness"><span class="name">InductiveMerkleTree</span>.<span class="name">functional_completeness</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">s</span> : <a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.Skeleton">BinaryTree.Skeleton</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">idx</span> : <span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.SkeletonLeafIndex">BinaryTree.SkeletonLeafIndex</a> <span class="fn">s</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">leaf_data_tree</span> : <span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.LeafData">BinaryTree.LeafData</a> <span class="fn">α</span> <span class="fn">s</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hash</span> : <span class="fn"><span class="fn">α</span> → <span class="fn">α</span> → <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.getPutativeRoot_with_hash">getPutativeRoot_with_hash</a> <span class="fn">idx</span> <span class="fn">(<span class="fn"><span class="fn">leaf_data_tree</span>.<a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.LeafData.get">get</a></span> <span class="fn">idx</span>)</span>
    <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.generateProof">generateProof</a> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.buildMerkleTree_with_hash">buildMerkleTree_with_hash</a> <span class="fn">leaf_data_tree</span> <span class="fn">hash</span>)</span> <span class="fn">idx</span>)</span> <span class="fn">hash</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><span class="fn">(<a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.buildMerkleTree_with_hash">buildMerkleTree_with_hash</a> <span class="fn">leaf_data_tree</span> <span class="fn">hash</span>)</span>.<a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.FullData.getRootValue">getRootValue</a></span></div></div><p>A functional form of the completeness theorem for Merkle trees.
This references the functional versions of <code><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.getPutativeRoot">getPutativeRoot</a></code> and <code><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.buildMerkleTree_with_hash">buildMerkleTree_with_hash</a></code></p></div></div><div class="decl" id="InductiveMerkleTree.completeness"><div class="theorem"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/InductiveMerkleTree.lean#L295-L322">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.completeness"><span class="name">InductiveMerkleTree</span>.<span class="name">completeness</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">α</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././VCVio/OracleComp/Constructions/UniformSelect.html#OracleComp.SelectableType">OracleComp.SelectableType</a> <span class="fn">α</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">s</span> : <a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.Skeleton">BinaryTree.Skeleton</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">leaf_data_tree</span> : <span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.LeafData">BinaryTree.LeafData</a> <span class="fn">α</span> <span class="fn">s</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">idx</span> : <span class="fn"><a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.SkeletonLeafIndex">BinaryTree.SkeletonLeafIndex</a> <span class="fn">s</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">preexisting_cache</span> : <span class="fn"><span class="fn">(<a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.spec">spec</a> <span class="fn">α</span>)</span>.<a href="../.././VCVio/OracleComp/QueryTracking/Structures.html#OracleSpec.QueryCache">QueryCache</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">(<span class="fn"><span class="fn">(<a href="../.././VCVio/OracleComp/SimSemantics/SimulateQ.html#OracleComp.simulateQ">OracleComp.simulateQ</a> <a href="../.././VCVio/OracleComp/QueryTracking/CachingOracle.html#randomOracle">randomOracle</a> <span class="fn">do
        let <span class="fn">cache</span> ← <span class="fn"><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.buildMerkleTree">buildMerkleTree</a> <span class="fn">leaf_data_tree</span></span>
        have proof : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <span class="fn">α</span></span> := <span class="fn"><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.generateProof">generateProof</a> <span class="fn">cache</span> <span class="fn">idx</span></span>
        let <span class="fn">__discr</span> ← <span class="fn"><a href="../.././ArkLib/CommitmentScheme/InductiveMerkleTree.html#InductiveMerkleTree.verifyProof">verifyProof</a> <span class="fn">idx</span> <span class="fn">(<span class="fn"><span class="fn">leaf_data_tree</span>.<a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.LeafData.get">get</a></span> <span class="fn">idx</span>)</span> <span class="fn"><span class="fn">cache</span>.<a href="../.././ArkLib/ToMathlib/Data/IndexedBinaryTree/Basic.html#BinaryTree.FullData.getRootValue">getRootValue</a></span> <span class="fn">proof</span></span>
        have x : <a href="../.././Init/Prelude.html#Unit">Unit</a> := <span class="fn">__discr</span>
        <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <a href="../.././Init/Prelude.html#PUnit.unit">PUnit.unit</a></span></span>)</span>.<a href="../.././Init/Control/State.html#StateT.run">run</a></span>
    <span class="fn">preexisting_cache</span>)</span>.<a href="../.././VCVio/OracleComp/Traversal.html#OracleComp.neverFails">neverFails</a></span></div></div><p>Completeness theorem for Merkle trees.</p><p>The proof proceeds by reducing to the functional completeness theorem by a theorem about
the OracleComp monad,
and then applying the functional version of the completeness theorem.</p></div></div></main>
<nav class="nav"><iframe src="../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>