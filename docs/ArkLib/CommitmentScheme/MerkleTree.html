<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../.././style.css"></link><link rel="icon" href="../.././favicon.svg"></link><link rel="mask-icon" href="../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../.././/declarations/declaration-data.bmp" as="image"></link><title>ArkLib.CommitmentScheme.MerkleTree</title><script defer="true" src="../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../.././";</script><script>const MODULE_NAME="ArkLib.CommitmentScheme.MerkleTree";</script><script type="module" src="../.././jump-src.js"></script><script type="module" src="../.././search.js"></script><script type="module" src="../.././expand-nav.js"></script><script type="module" src="../.././how-about.js"></script><script type="module" src="../.././instances.js"></script><script type="module" src="../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">ArkLib</span>.<span class="name">CommitmentScheme</span>.<span class="name">MerkleTree</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../.././Init.html">Init</a></li><li><a href="../.././Mathlib/Data/Vector/Snoc.html">Mathlib.Data.Vector.Snoc</a></li><li><a href="../.././VCVio/OracleComp/QueryTracking/CachingOracle.html">VCVio.OracleComp.QueryTracking.CachingOracle</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-ArkLib.CommitmentScheme.MerkleTree" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#MerkleTree.spec"><span class="name">MerkleTree</span>.<span class="name">spec</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.domain_def"><span class="name">MerkleTree</span>.<span class="name">domain_def</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.range_def"><span class="name">MerkleTree</span>.<span class="name">range_def</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.singleHash"><span class="name">MerkleTree</span>.<span class="name">singleHash</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.Cache"><span class="name">MerkleTree</span>.<span class="name">Cache</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.Cache.cons"><span class="name">MerkleTree</span>.<span class="name">Cache</span>.<span class="name">cons</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.Cache.upper"><span class="name">MerkleTree</span>.<span class="name">Cache</span>.<span class="name">upper</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.Cache.leaves"><span class="name">MerkleTree</span>.<span class="name">Cache</span>.<span class="name">leaves</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.Cache.upper_cons"><span class="name">MerkleTree</span>.<span class="name">Cache</span>.<span class="name">upper_cons</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.Cache.leaves_cons"><span class="name">MerkleTree</span>.<span class="name">Cache</span>.<span class="name">leaves_cons</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.buildLayer"><span class="name">MerkleTree</span>.<span class="name">buildLayer</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.buildMerkleTree"><span class="name">MerkleTree</span>.<span class="name">buildMerkleTree</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.getRoot"><span class="name">MerkleTree</span>.<span class="name">getRoot</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.findNeighbors"><span class="name">MerkleTree</span>.<span class="name">findNeighbors</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.getRoot_trivial"><span class="name">MerkleTree</span>.<span class="name">getRoot_trivial</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.getRoot_single"><span class="name">MerkleTree</span>.<span class="name">getRoot_single</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.generateProof"><span class="name">MerkleTree</span>.<span class="name">generateProof</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.getPutativeRoot"><span class="name">MerkleTree</span>.<span class="name">getPutativeRoot</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.verifyProof"><span class="name">MerkleTree</span>.<span class="name">verifyProof</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.buildLayer_neverFails"><span class="name">MerkleTree</span>.<span class="name">buildLayer_neverFails</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.buildMerkleTree_neverFails"><span class="name">MerkleTree</span>.<span class="name">buildMerkleTree_neverFails</span></a></div><div class="nav_link"><a class="break_within" href="#MerkleTree.completeness"><span class="name">MerkleTree</span>.<span class="name">completeness</span></a></div></nav><main>
<div class="mod_doc"><h1 class="markdown-heading" id="Merkle-Trees-as-a-vector-commitment">Merkle Trees as a vector commitment <a class="hover-link" href="#Merkle-Trees-as-a-vector-commitment">#</a></h1><h2 class="markdown-heading" id="Notes-TODOs">Notes &amp; TODOs <a class="hover-link" href="#Notes-TODOs">#</a></h2><p>We want this treatment to be as comprehensive as possible. In particular, our formalization
should (eventually) include all complexities such as the following:</p><ul>
<li>Multi-instance extraction &amp; simulation</li>
<li>Dealing with arbitrary trees (may have arity &gt; 2, or is not complete)</li>
<li>Path pruning optimization</li>
</ul></div><div class="decl" id="MerkleTree.spec"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L29-L35">source</a></div><div class="attributes">@[reducible]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.spec"><span class="name">MerkleTree</span>.<span class="name">spec</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././VCVio/OracleComp/OracleSpec.html#OracleSpec">OracleSpec</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Define the domain &amp; range of the (single) oracle needed for constructing a Merkle tree with
elements from some type <code>α</code>.</p><p>We may instantiate <code>α</code> with <code><a href="../.././Init/Prelude.html#BitVec">BitVec</a> n</code> or <code><a href="../.././Init/Prelude.html#Fin">Fin</a> (2 ^ n)</code> to construct a Merkle tree for boolean
vectors of length <code>n</code>.</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-MerkleTree.spec" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MerkleTree.domain_def"><div class="theorem"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L37-L38">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.domain_def"><span class="name">MerkleTree</span>.<span class="name">domain_def</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn"><span class="fn">(<a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.spec">spec</a> <span class="fn">α</span>)</span>.<a href="../.././VCVio/OracleComp/OracleSpec.html#OracleSpec.domain">domain</a></span> <a href="../.././Init/Prelude.html#Unit.unit">(</a><a href="../.././Init/Prelude.html#Unit.unit">)</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> (<span class="fn">α</span> <a href="../.././Init/Prelude.html#Prod">×</a> <span class="fn">α</span>)</div></div></div></div><div class="decl" id="MerkleTree.range_def"><div class="theorem"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L40-L41">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.range_def"><span class="name">MerkleTree</span>.<span class="name">range_def</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn"><span class="fn">(<a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.spec">spec</a> <span class="fn">α</span>)</span>.<a href="../.././VCVio/OracleComp/OracleSpec.html#OracleSpec.range">range</a></span> <a href="../.././Init/Prelude.html#Unit.unit">(</a><a href="../.././Init/Prelude.html#Unit.unit">)</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">α</span></div></div></div></div><div class="decl" id="MerkleTree.singleHash"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L47-L50">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.singleHash"><span class="name">MerkleTree</span>.<span class="name">singleHash</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">left </span><span class="fn">right</span> : <span class="fn">α</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././VCVio/OracleComp/OracleComp.html#OracleComp">OracleComp</a> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.spec">spec</a> <span class="fn">α</span>)</span> <span class="fn">α</span></span></div></div><p>Example: a single hash computation</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-MerkleTree.singleHash" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MerkleTree.Cache"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L52-L53">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache"><span class="name">MerkleTree</span>.<span class="name">Cache</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href="../.././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>Cache for Merkle tree. Indexed by <code>j : <a href="../.././Init/Prelude.html#Fin">Fin</a> (n + 1)</code>, i.e. <code>j = 0, 1, ..., n</code>.</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-MerkleTree.Cache" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MerkleTree.Cache.cons"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L55-L58">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache.cons"><span class="name">MerkleTree</span>.<span class="name">Cache</span>.<span class="name">cons</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href="../.././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">leaves</span> : <span class="fn"><a href="../.././Mathlib/Data/Vector/Defs.html#List.Vector">List.Vector</a> <span class="fn">α</span> (<span class="fn">2</span> <a href="../.././Init/Prelude.html#HPow.hPow">^</a> (<span class="fn">n</span> <a href="../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>))</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">cache</span> : <span class="fn"><a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache">Cache</a> <span class="fn">α</span> <span class="fn">n</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache">Cache</a> <span class="fn">α</span> (<span class="fn">n</span> <a href="../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>)</span></div></div><p>Add a base layer to the cache</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-MerkleTree.Cache.cons" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MerkleTree.Cache.upper"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L60-L63">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache.upper"><span class="name">MerkleTree</span>.<span class="name">Cache</span>.<span class="name">upper</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href="../.././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">cache</span> : <span class="fn"><a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache">Cache</a> <span class="fn">α</span> (<span class="fn">n</span> <a href="../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>)</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache">Cache</a> <span class="fn">α</span> <span class="fn">n</span></span></div></div><p>Removes the leaves layer to the cache, returning only the layers of the tree above this</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-MerkleTree.Cache.upper" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MerkleTree.Cache.leaves"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L65-L67">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache.leaves"><span class="name">MerkleTree</span>.<span class="name">Cache</span>.<span class="name">leaves</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href="../.././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">cache</span> : <span class="fn"><a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache">Cache</a> <span class="fn">α</span> (<span class="fn">n</span> <a href="../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>)</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Mathlib/Data/Vector/Defs.html#List.Vector">List.Vector</a> <span class="fn">α</span> (<span class="fn">2</span> <a href="../.././Init/Prelude.html#HPow.hPow">^</a> (<span class="fn">n</span> <a href="../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>))</span></div></div><p>Returns the leaves of the cache</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-MerkleTree.Cache.leaves" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MerkleTree.Cache.upper_cons"><div class="theorem"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L70-L73">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache.upper_cons"><span class="name">MerkleTree</span>.<span class="name">Cache</span>.<span class="name">upper_cons</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href="../.././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">leaves</span> : <span class="fn"><a href="../.././Mathlib/Data/Vector/Defs.html#List.Vector">List.Vector</a> <span class="fn">α</span> (<span class="fn">2</span> <a href="../.././Init/Prelude.html#HPow.hPow">^</a> (<span class="fn">n</span> <a href="../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>))</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">cache</span> : <span class="fn"><a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache">Cache</a> <span class="fn">α</span> <span class="fn">n</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache.upper">upper</a> <span class="fn">α</span> <span class="fn">n</span> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache.cons">cons</a> <span class="fn">α</span> <span class="fn">n</span> <span class="fn">leaves</span> <span class="fn">cache</span>)</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">cache</span></div></div></div></div><div class="decl" id="MerkleTree.Cache.leaves_cons"><div class="theorem"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L76-L79">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache.leaves_cons"><span class="name">MerkleTree</span>.<span class="name">Cache</span>.<span class="name">leaves_cons</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href="../.././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">leaves</span> : <span class="fn"><a href="../.././Mathlib/Data/Vector/Defs.html#List.Vector">List.Vector</a> <span class="fn">α</span> (<span class="fn">2</span> <a href="../.././Init/Prelude.html#HPow.hPow">^</a> (<span class="fn">n</span> <a href="../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>))</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">cache</span> : <span class="fn"><a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache">Cache</a> <span class="fn">α</span> <span class="fn">n</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache.leaves">Cache.leaves</a> <span class="fn">α</span> <span class="fn">n</span> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache.cons">cons</a> <span class="fn">α</span> <span class="fn">n</span> <span class="fn">leaves</span> <span class="fn">cache</span>)</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">leaves</span></div></div></div></div><div class="decl" id="MerkleTree.buildLayer"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L81-L92">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.buildLayer"><span class="name">MerkleTree</span>.<span class="name">buildLayer</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href="../.././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">leaves</span> : <span class="fn"><a href="../.././Mathlib/Data/Vector/Defs.html#List.Vector">List.Vector</a> <span class="fn">α</span> (<span class="fn">2</span> <a href="../.././Init/Prelude.html#HPow.hPow">^</a> (<span class="fn">n</span> <a href="../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>))</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././VCVio/OracleComp/OracleComp.html#OracleComp">OracleComp</a> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.spec">spec</a> <span class="fn">α</span>)</span> <span class="fn">(<a href="../.././Mathlib/Data/Vector/Defs.html#List.Vector">List.Vector</a> <span class="fn">α</span> (<span class="fn">2</span> <a href="../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">n</span>))</span></span></div></div><p>Compute the next layer of the Merkle tree</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-MerkleTree.buildLayer" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MerkleTree.buildMerkleTree"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L94-L105">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.buildMerkleTree"><span class="name">MerkleTree</span>.<span class="name">buildMerkleTree</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href="../.././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">leaves</span> : <span class="fn"><a href="../.././Mathlib/Data/Vector/Defs.html#List.Vector">List.Vector</a> <span class="fn">α</span> (<span class="fn">2</span> <a href="../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">n</span>)</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././VCVio/OracleComp/OracleComp.html#OracleComp">OracleComp</a> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.spec">spec</a> <span class="fn">α</span>)</span> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache">Cache</a> <span class="fn">α</span> <span class="fn">n</span>)</span></span></div></div><p>Build the full Merkle tree, returning the cache</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-MerkleTree.buildMerkleTree" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MerkleTree.getRoot"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L107-L109">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.getRoot"><span class="name">MerkleTree</span>.<span class="name">getRoot</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">n</span> : <a href="../.././Init/Prelude.html#Nat">ℕ</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">cache</span> : <span class="fn"><a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache">Cache</a> <span class="fn">α</span> <span class="fn">n</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">α</span></div></div><p>Get the root of the Merkle tree</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-MerkleTree.getRoot" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MerkleTree.findNeighbors"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L111-L122">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.findNeighbors"><span class="name">MerkleTree</span>.<span class="name">findNeighbors</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">n</span> : <a href="../.././Init/Prelude.html#Nat">ℕ</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">i</span> : <span class="fn"><a href="../.././Init/Prelude.html#Fin">Fin</a> (<span class="fn">2</span> <a href="../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">n</span>)</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">layer</span> : <span class="fn"><a href="../.././Init/Prelude.html#Fin">Fin</a> <span class="fn">n</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Fin">Fin</a> (<span class="fn">2</span> <a href="../.././Init/Prelude.html#HPow.hPow">^</a> (<span class="fn">↑<span class="fn">layer</span></span> <a href="../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>))</span></div></div><p>Figure out the indices of the Merkle tree nodes that are needed to
recompute the root from the given leaf</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-MerkleTree.findNeighbors" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MerkleTree.getRoot_trivial"><div class="theorem"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L126-L128">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.getRoot_trivial"><span class="name">MerkleTree</span>.<span class="name">getRoot_trivial</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">a</span> : <span class="fn">α</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.getRoot">getRoot</a> <span class="fn">α</span></span> <a href="../.././Init/Prelude.html#Functor.map">&lt;$&gt;</a> <span class="fn"><a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.buildMerkleTree">buildMerkleTree</a> <span class="fn">α</span> <span class="fn">0</span> <a href="../.././Init/Prelude.html#Subtype.mk">⟨</a><a href="../.././Init/Prelude.html#List.cons">[</a><span class="fn">a</span><a href="../.././Init/Prelude.html#List.cons">]</a>, <span class="fn">⋯</span><a href="../.././Init/Prelude.html#Subtype.mk">⟩</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn">a</span></span></div></div></div></div><div class="decl" id="MerkleTree.getRoot_single"><div class="theorem"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L130-L135">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.getRoot_single"><span class="name">MerkleTree</span>.<span class="name">getRoot_single</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">a </span><span class="fn">b</span> : <span class="fn">α</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.getRoot">getRoot</a> <span class="fn">α</span></span> <a href="../.././Init/Prelude.html#Functor.map">&lt;$&gt;</a> <span class="fn"><a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.buildMerkleTree">buildMerkleTree</a> <span class="fn">α</span> <span class="fn">1</span> <a href="../.././Init/Prelude.html#Subtype.mk">⟨</a><a href="../.././Init/Prelude.html#List.cons">[</a><span class="fn">a</span><a href="../.././Init/Prelude.html#List.cons">,</a> <span class="fn">b</span><a href="../.././Init/Prelude.html#List.cons">]</a>, <span class="fn">⋯</span><a href="../.././Init/Prelude.html#Subtype.mk">⟩</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#liftM">liftM</a> <span class="fn">(<a href="../.././VCVio/OracleComp/OracleComp.html#OracleSpec.OracleQuery.query">OracleSpec.query</a> <a href="../.././Init/Prelude.html#Unit.unit">(</a><a href="../.././Init/Prelude.html#Unit.unit">)</a> <a href="../.././Init/Prelude.html#Prod.mk">(</a><span class="fn">a</span><a href="../.././Init/Prelude.html#Prod.mk">,</a> <span class="fn">b</span><a href="../.././Init/Prelude.html#Prod.mk">)</a>)</span></span></div></div></div></div><div class="decl" id="MerkleTree.generateProof"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L141-L148">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.generateProof"><span class="name">MerkleTree</span>.<span class="name">generateProof</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">n</span> : <a href="../.././Init/Prelude.html#Nat">ℕ</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">i</span> : <span class="fn"><a href="../.././Init/Prelude.html#Fin">Fin</a> (<span class="fn">2</span> <a href="../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">n</span>)</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">cache</span> : <span class="fn"><a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.Cache">Cache</a> <span class="fn">α</span> <span class="fn">n</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Mathlib/Data/Vector/Defs.html#List.Vector">List.Vector</a> <span class="fn">α</span> <span class="fn">n</span></span></div></div><p>Generate a Merkle proof that a given leaf at index <code>i</code> is in the Merkle tree. The proof consists
of the Merkle tree nodes that are needed to recompute the root from the given leaf.</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-MerkleTree.generateProof" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MerkleTree.getPutativeRoot"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L150-L174">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.getPutativeRoot"><span class="name">MerkleTree</span>.<span class="name">getPutativeRoot</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">n</span> : <a href="../.././Init/Prelude.html#Nat">ℕ</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">i</span> : <span class="fn"><a href="../.././Init/Prelude.html#Fin">Fin</a> (<span class="fn">2</span> <a href="../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">n</span>)</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">leaf</span> : <span class="fn">α</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">proof</span> : <span class="fn"><a href="../.././Mathlib/Data/Vector/Defs.html#List.Vector">List.Vector</a> <span class="fn">α</span> <span class="fn">n</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././VCVio/OracleComp/OracleComp.html#OracleComp">OracleComp</a> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.spec">spec</a> <span class="fn">α</span>)</span> <span class="fn">α</span></span></div></div><p>Given a leaf index, a leaf at that index, and putative proof,
returns the hash that would be the root of the tree if the proof was valid.
i.e. the hash obtained by combining the leaf in sequence with each member of the proof,
according to its index.</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-MerkleTree.getPutativeRoot" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MerkleTree.verifyProof"><div class="def"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L176-L183">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.verifyProof"><span class="name">MerkleTree</span>.<span class="name">verifyProof</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">α</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">n</span> : <a href="../.././Init/Prelude.html#Nat">ℕ</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">i</span> : <span class="fn"><a href="../.././Init/Prelude.html#Fin">Fin</a> (<span class="fn">2</span> <a href="../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">n</span>)</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">leaf </span><span class="fn">root</span> : <span class="fn">α</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">proof</span> : <span class="fn"><a href="../.././Mathlib/Data/Vector/Defs.html#List.Vector">List.Vector</a> <span class="fn">α</span> <span class="fn">n</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././VCVio/OracleComp/OracleComp.html#OracleComp">OracleComp</a> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.spec">spec</a> <span class="fn">α</span>)</span> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Verify a Merkle proof <code>proof</code> that a given <code>leaf</code> at index <code>i</code> is in the Merkle tree with given
<code>root</code>.
Works by computing the putative root based on the branch, and comparing that to the actual root.
Outputs <code>failure</code> if the proof is invalid.</p><details><summary>Equations</summary><ul class="equations"></ul></details><details id="instances-for-list-MerkleTree.verifyProof" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MerkleTree.buildLayer_neverFails"><div class="theorem"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L186-L194">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.buildLayer_neverFails"><span class="name">MerkleTree</span>.<span class="name">buildLayer_neverFails</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn">inst</span> : <span class="fn"><a href="../.././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">α</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn">inst_1</span> : <span class="fn"><a href="../.././VCVio/OracleComp/Constructions/UniformSelect.html#OracleComp.SelectableType">OracleComp.SelectableType</a> <span class="fn">α</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">preexisting_cache</span> : <span class="fn"><span class="fn">(<a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.spec">spec</a> <span class="fn">α</span>)</span>.<a href="../.././VCVio/OracleComp/QueryTracking/Structures.html#OracleSpec.QueryCache">QueryCache</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href="../.././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">leaves</span> : <span class="fn"><a href="../.././Mathlib/Data/Vector/Defs.html#List.Vector">List.Vector</a> <span class="fn">α</span> (<span class="fn">2</span> <a href="../.././Init/Prelude.html#HPow.hPow">^</a> (<span class="fn">n</span> <a href="../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>))</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">(<span class="fn"><span class="fn">(<a href="../.././VCVio/OracleComp/SimSemantics/SimulateQ.html#OracleComp.simulateQ">OracleComp.simulateQ</a> <a href="../.././VCVio/OracleComp/QueryTracking/CachingOracle.html#randomOracle">randomOracle</a> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.buildLayer">buildLayer</a> <span class="fn">α</span> <span class="fn">n</span> <span class="fn">leaves</span>)</span>)</span>.<a href="../.././Init/Control/State.html#StateT.run">run</a></span> <span class="fn">preexisting_cache</span>)</span>.<a href="../.././VCVio/OracleComp/Traversal.html#OracleComp.neverFails">neverFails</a></span></div></div></div></div><div class="decl" id="MerkleTree.buildMerkleTree_neverFails"><div class="theorem"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L196-L214">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.buildMerkleTree_neverFails"><span class="name">MerkleTree</span>.<span class="name">buildMerkleTree_neverFails</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">α</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././VCVio/OracleComp/Constructions/UniformSelect.html#OracleComp.SelectableType">OracleComp.SelectableType</a> <span class="fn">α</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">n</span> : <a href="../.././Init/Prelude.html#Nat">ℕ</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">leaves</span> : <span class="fn"><a href="../.././Mathlib/Data/Vector/Defs.html#List.Vector">List.Vector</a> <span class="fn">α</span> (<span class="fn">2</span> <a href="../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">n</span>)</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">preexisting_cache</span> : <span class="fn"><span class="fn">(<a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.spec">spec</a> <span class="fn">α</span>)</span>.<a href="../.././VCVio/OracleComp/QueryTracking/Structures.html#OracleSpec.QueryCache">QueryCache</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">(<span class="fn"><span class="fn">(<a href="../.././VCVio/OracleComp/SimSemantics/SimulateQ.html#OracleComp.simulateQ">OracleComp.simulateQ</a> <a href="../.././VCVio/OracleComp/QueryTracking/CachingOracle.html#randomOracle">randomOracle</a> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.buildMerkleTree">buildMerkleTree</a> <span class="fn">α</span> <span class="fn">n</span> <span class="fn">leaves</span>)</span>)</span>.<a href="../.././Init/Control/State.html#StateT.run">run</a></span> <span class="fn">preexisting_cache</span>)</span>.<a href="../.././VCVio/OracleComp/Traversal.html#OracleComp.neverFails">neverFails</a></span></div></div><p>Building a Merkle tree never results in failure
(no matter what queries have already been made to the oracle before it runs).</p></div></div><div class="decl" id="MerkleTree.completeness"><div class="theorem"><div class="gh_link"><a href="https://github.com/Verified-zkEVM/ArkLib/blob/06102f457d5f1583099557f4cc414e62d6f68e6a/ArkLib/CommitmentScheme/MerkleTree.lean#L216-L239">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.completeness"><span class="name">MerkleTree</span>.<span class="name">completeness</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">α</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">α</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">α</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././VCVio/OracleComp/Constructions/UniformSelect.html#OracleComp.SelectableType">OracleComp.SelectableType</a> <span class="fn">α</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">n</span> : <a href="../.././Init/Prelude.html#Nat">ℕ</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">leaves</span> : <span class="fn"><a href="../.././Mathlib/Data/Vector/Defs.html#List.Vector">List.Vector</a> <span class="fn">α</span> (<span class="fn">2</span> <a href="../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">n</span>)</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">i</span> : <span class="fn"><a href="../.././Init/Prelude.html#Fin">Fin</a> (<span class="fn">2</span> <a href="../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">n</span>)</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hash</span> : <span class="fn"><span class="fn">α</span> <a href="../.././Init/Prelude.html#Prod">×</a> <span class="fn">α</span> → <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">preexisting_cache</span> : <span class="fn"><span class="fn">(<a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.spec">spec</a> <span class="fn">α</span>)</span>.<a href="../.././VCVio/OracleComp/QueryTracking/Structures.html#OracleSpec.QueryCache">QueryCache</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">(<span class="fn"><span class="fn">(<a href="../.././VCVio/OracleComp/SimSemantics/SimulateQ.html#OracleComp.simulateQ">OracleComp.simulateQ</a> <a href="../.././VCVio/OracleComp/QueryTracking/CachingOracle.html#randomOracle">randomOracle</a> <span class="fn">do
        let <span class="fn">cache</span> ← <span class="fn"><a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.buildMerkleTree">buildMerkleTree</a> <span class="fn">α</span> <span class="fn">n</span> <span class="fn">leaves</span></span>
        have proof : <span class="fn"><a href="../.././Mathlib/Data/Vector/Defs.html#List.Vector">List.Vector</a> <span class="fn">α</span> <span class="fn">n</span></span> := <span class="fn"><a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.generateProof">generateProof</a> <span class="fn">α</span> <span class="fn">i</span> <span class="fn">cache</span></span>
        <span class="fn"><a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.verifyProof">verifyProof</a> <span class="fn">α</span> <span class="fn">i</span> <span class="fn">leaves</span><a href="../.././Init/GetElem.html#GetElem.getElem">[</a><span class="fn">i</span><a href="../.././Init/GetElem.html#GetElem.getElem">]</a> <span class="fn">(<a href="../.././ArkLib/CommitmentScheme/MerkleTree.html#MerkleTree.getRoot">getRoot</a> <span class="fn">α</span> <span class="fn">cache</span>)</span> <span class="fn">proof</span></span>
        <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <a href="../.././Init/Prelude.html#PUnit.unit">PUnit.unit</a></span></span>)</span>.<a href="../.././Init/Control/State.html#StateT.run">run</a></span>
    <span class="fn">preexisting_cache</span>)</span>.<a href="../.././VCVio/OracleComp/Traversal.html#OracleComp.neverFails">neverFails</a></span></div></div><p>Completeness theorem for Merkle trees: for any full binary tree with <code>2 ^ n</code> leaves, and for any
index <code>i</code>, the verifier accepts the opening proof at index <code>i</code> generated by the prover.</p></div></div></main>
<nav class="nav"><iframe src="../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>